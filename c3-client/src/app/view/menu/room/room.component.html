
<!-- Full Size -->
<div class="v-flex main-container" *ngIf="roomInfo && showRoomGui">
  <ng-container *ngIf="!showSettings">

    <!-- HFlex -->
    <div class="h-flex" style="gap: 40px; overflow: auto;">

      <!-- Left Panel (Chat) -->
      <div class="room-section" style="flex-grow: 1; flex-basis: 0;">
        <app-chat-container #chat
          [roomId]="roomInfo.id"
          [(chatMessageInput)]="chatMessageInput"
          [chatMessages]="chatMessages"
        ></app-chat-container>
      </div>

      <!-- Right Panel (room actions + player list) -->
      <div class="room-section v-flex" style="flex-grow: 1; flex-basis: 0; max-width: 1000px;">
        <div class="gui-button-row">
          <button *ngIf="isHost()" class="gui-button gui-button-main" [disabled]="!canStartGame()" (click)="onStartGameClick()">Start game</button>
          <button *ngIf="lastGameReplay" class="gui-button" (click)="onDownloadLastReplayClick()">Replay</button>

          <!-- host buttons -->
          <button *ngIf="isHost()" class="gui-button" [disabled]="isRunning()" (click)="onResetScoresClick()">Reset scores</button>
          <button *ngIf="isHost()" class="gui-button" [disabled]="isRunning()" (click)="onSettingsClick()">Rule settings</button>

          <!-- debug buttons -->
          <ng-container *ngIf="debug">
            <button *ngIf="lastGameReplay" class="gui-button" (click)="onVerifyLastReplayClick()">Verify replay</button>
            <button class="gui-button" (click)="onDownloadGameStateClick()">Download debug state</button>
          </ng-container>

          <div style="flex-grow: 1;"></div>

          <!-- spectator toggle button-->
          <button class="gui-button" (click)="onToggleSpectatorModeClick()">{{isSpectator() ? 'Watch' : 'Play'}}</button>
        </div>

        <div>
          <app-room-auto-start-countdown
            #autoStartCountdown
            [countdownEndMs]="countdownEndMs"
            [running]="isRunning()"
          ></app-room-auto-start-countdown>
        </div>

        <app-room-player-list
          [roomInfo]="this.roomInfo"
        ></app-room-player-list>
      </div>
    </div>
  </ng-container>

  <!-- Rule Settings -->
  <ng-container *ngIf="showSettings">
    <div class="v-flex room-section">
      <app-room-settings
        [currentSettings]="roomInfo.settings"
        [editMode]="isHost()"
        (save)="onSaveSettings($event)"
        (cancel)="onCancelSettings()"
      ></app-room-settings>
    </div>
  </ng-container>
</div>
